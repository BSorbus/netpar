<% input_disabled ||= false  
   #if input_disabled is not passed to the partial it doesn't crash. 
   # We default it to false 
%>

<% if @exam.errors.any? %>
  <div id="error_explanation" class="panel panel-danger">
    <div class="panel-body">
      <ul>
      <% @exam.errors.full_messages.each do |msg| %>
        <li><h5><%= msg %></h5></li>
      <% end %>
      </ul>
    </div>
  </div>
<% end %>


<div class="row">
  <div class="form-group col-sm-7">
    <%= f.label :esod_matter_id, class: "control-label" %>
    <%= f.hidden_field :esod_matter_id,
                      class: "form-control input-sm esod_matter_for_exam_select_#{params[:category_service]}", 
                      placeholder: "Wybierz Sprawę (Sesje egzaminacyjne #{params[:category_service].upcase})",
                      #disabled: !@exam.new_record?,
                      disabled: @exam.esod_matter_id.present? && !@exam.errors.present?,
                      style: "width:100%" %>
    <small class="help-block"><%=t 'help_block_text.select2_esod_matter' %></small>
  </div>

  <div class="form-group col-sm-5">
    <%= f.label :esod_category, class: 'control-label' %>
    <%= f.select :esod_category, 
          options_for_select([["#{Esodes::esod_matter_iks_name(Esodes::SESJA)}", Esodes::SESJA],
                              ["#{Esodes::esod_matter_iks_name(Esodes::SESJA_BEZ_EGZAMINOW)}", Esodes::SESJA_BEZ_EGZAMINOW]], 
              selected: @exam.esod_category), 
          { include_blank: false}, 
          { autofocus: @exam.new_record?, class: 'form-control input-sm', disabled: params[:category_service] == 'l' || @exam.esod_matter_id.present? } %>
  </div>

</div>

<hr class="hr-without-top-margin">

<div class="row">
  <div class="col-sm-7">

    <div class="row">
      <div class="form-group col-sm-6">
        <%= f.label :number, class: 'control-label' %>
        <%= f.text_field :number, autofocus: !@exam.new_record?, class: 'form-control input-sm', placeholder: t("placeholder_text.exam_#{params[:category_service]}.form.number"), disabled: input_disabled %>
      </div>

      <div class="form-group col-sm-6">
        <%= f.label :date_exam, class: 'control-label' %>
        <%= f.text_field :date_exam, class: 'datepicker form-control input-sm', disabled: input_disabled %>
      </div>
    </div>  <!-- /row -->

    <div class="row">
      <div class="form-group col-sm-12">
        <%= f.label :place_exam, class: 'control-label' %>
        <%= f.text_field :place_exam, class: 'form-control input-sm', disabled: input_disabled %>
      </div>
    </div>  <!-- /row -->

    <hr class="hr-without-top-margin">

    <div class="row">
      <div class="form-group col-sm-6">
        <%= f.label :chairman, class: 'control-label' %>
        <%= f.text_field :chairman, class: 'form-control input-sm', disabled: input_disabled %>
      </div>
      <div class="form-group col-sm-6">
        <%= f.label :secretary, class: 'control-label' %>
        <%= f.text_field :secretary, class: 'form-control input-sm', disabled: input_disabled %>
      </div>
    </div>  <!-- /row -->


    <div class="row">
      <div class="col-sm-6">
        <p><strong>Członkowie komisji:</strong></p>
      </div>
    </div>  <!-- /row -->

    <%= f.fields_for :examiners do |e| %>
      <div class="row">
        <div class="form-group col-sm-6">
          <%#= e.label :name, class: 'control-label' %>
          <%= e.text_field :name, class: 'form-control input-sm', disabled: input_disabled %>

          <% unless @exam.new_record? %>
            <%= e.check_box :_destroy %>
            <%= e.label :_destroy, 'usuń' %>
          <% end%>

        </div>
      </div>  <!-- /row -->
    <% end %>  <!-- /f.fields_for -->


    <div class="row">
      <div class="form-group col-sm-12">
        <%= f.label :note, class: 'control-label' %>
        <%= f.text_area :note, :rows => 4, :cols => 50, class: 'form-control input-sm', disabled: input_disabled %>
      </div>
    </div>


  </div> <!-- /col-sm-7 -->

  <div class="col-sm-5">
    <blockquote>
      <p>Uwaga!</p>
      <h5>1. Pozostawienie pustego pola "<strong><%= Exam.human_attribute_name('esod_matter') %></strong>" 
        podczas dodawania nowej sesji egzaminacyjnej automatycznie wygeneruje sprawę w systemie ESOD!<br>
        Jeżeli nie chcesz tworzyć nowej sprawy w systemie ESOD musisz wybrać z listy spraw istniejącą już pozycję.</h5>
      <h5>2. Wybranie określonej sprawy w polu "<strong><%= Exam.human_attribute_name('esod_matter') %></strong>"
        i wprowadzenie wartości niezgodnych z jej tytułem i opisem spowoduje zmianę danych w ESOD!</h5>
    </blockquote>
  </div> <!-- /col-sm-5 -->
</div> <!-- /row -->

<hr class="hr-without-top-margin">


<% if input_disabled %>
  <!-- for "Show" -->
<% else %>
  <!-- form "New"/"Edit" -->
  <div class="row">
    <%= link_to t('Index', default: t("helpers.links.index")), exams_path(params[:category_service]), :class => 'btn btn-default glyphicon glyphicon-th-list' %>

    <%= link_to t('Back', default: t("helpers.links.back")), :back, :class => 'btn btn-default glyphicon glyphicon-arrow-left' %>
    <%= f.submit nil, :class => 'btn btn-primary' %>
  </div> <!-- /row -->
<% end %>
  



